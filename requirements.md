# 요구사항 요약

## 추가 1
- 페르소나가 5개에서 6개로 그 개수와 내용이 변경(“Young Evelyn”, “Bagle”, “Actor”, “IRS Office”, “Singer”, "Sign Spinner").
- 노드를 선택하면 모달 뷰어는 이미지가 아닌 폴더 'videos' 내의 영상을 재생.

## 추가 2 — 비디오 스크럽 기반 인터랙션
- 각 노드에 연결된 영상은 약 5초 길이로 제공되며, 팝업이 열리면 자동 재생이 아닌 **사용자 스크롤**에 따라 `currentTime`이 이동해야 합니다.
- 스크롤 진행도는 0~1 비율로 정규화하여 영상의 전체 길이에 매핑하고, 과도한 이벤트 처리를 피하기 위해 `requestAnimationFrame`을 통한 스로틀링을 적용합니다.
- 팝업이 닫히면 스크롤 리스너와 비디오 리소스를 해제해 리소스 누수와 의도치 않은 시간 이동을 방지합니다.

## 추가 3 — 핫스팟 기반 게임 시스템
- 노드 데이터에는 `hotspots` 배열을 정의하여, `timeRange`(초 단위)와 정규화 좌표(`x`,`y`,`w`,`h`)로 표현된 클릭 영역을 선언합니다.
- 영상의 `currentTime`이 `timeRange` 안에 있을 때만 해당 영역을 표시하며, 클릭 시 새로운 노드를 그래프에 추가하거나 기존 노드를 열어 인터랙티브 분기를 제공합니다.
- 새로 생성된 노드는 기존 force 그래프에 동적으로 합류하고, 링크가 즉시 업데이트되도록 시뮬레이션을 재시작해야 합니다.

## 추가 4 — 핫스팟 인스펙터 지원
- 제작 중에는 단축키 기반 “핫스팟 인스펙터”를 제공하여 팝업 내부에서 드래그 박스를 그리면 정규화 좌표와 권장 `timeRange` 템플릿을 콘솔 및 클립보드로 출력하도록 합니다.
- 인스펙터는 `I` 토글, `[`, `]` 프레임 스텝 이동(Shift 시 가속)과 같은 키바인딩을 제공하며, 배포 시에는 기본 비활성화 상태를 유지합니다.

## 추가 5 — 장식용 더미 노드
- 장식 목적의 노드는 데이터 모델에 `decorative: true` 플래그로 명시하며, `video`와 `hotspots` 속성은 정의하지 않습니다.
- 기본 스타일 가이드는 `appearance.opacity`(기본 0.3, 허용 범위 0.25~0.4)를 통해 투명하게 표현하고, 시뮬레이션에는 포함되지만 상호작용 대상에서는 제외합니다.
- 기본 노드 반지름 대비 0.9배 크기를 적용해 본편 노드보다 작게 보이도록 하며, 반지름 계산시 `appearance.scale` 등 별도 속성으로 재정의할 수 있습니다.
- 렌더링 시 `.node--decorative` 클래스를 사용해 포인터 이벤트를 차단하고, 포커스 가능 요소 목록에서도 제외하여 팝업이 열리지 않도록 합니다.
- 라벨과 HUD 요소는 기본적으로 숨기되, 필요 시 별도의 `appearance` 설정으로 재정의할 수 있도록 합니다.

## 추가 6 — 스크롤 속도 기반 오디오·하프틱 피드백
- `sounds/tick.wav`(또는 동등한 단일 샘플)을 사운드 피드백의 공통 자산으로 사용해 스크롤 스크럽과 클릭 인터랙션 모두에서 동일한 “틱” 감각을 제공합니다.
- 스크롤 이벤트 처리 시 최근 스크롤 거리와 시간을 기준으로 최소 재생 간격(예: 90~120ms)과 임계 스크롤 이동량(픽셀 단위)을 만족할 때마다 효과음을 재생하고, 스크롤 속도에 따라 `playbackRate`를 0.8~1.3 범위로 매핑합니다.
- 모바일 기기에서는 `navigator.vibrate(10)`으로 짧은 진동을 함께 트리거하되, 지원하지 않는 환경에서는 조용히 무시합니다.
- 클릭 이벤트(핫스팟, 노드 등 사용자 액션 피드백)는 동일한 `tick.wav`를 공유하며, 재생 전에 `currentTime`을 0으로 리셋해 중첩 클릭에도 즉시 반응합니다.
- 브라우저 오토플레이 정책을 준수하기 위해 최초 사용자 제스처가 발생한 이후에만 오디오 컨텍스트를 활성화하고, 재생 실패 시 graceful fallback 메시지를 로그로 남깁니다.

## 추가 7 — 링크 생성 흐름 리셋
- 초기 로드시 `links` 배열은 비어 있거나 시각적으로 숨겨진 상태에서 시작하며, 모든 노드는 “고립된” 점으로 표현됩니다.
- 사용자가 핫스팟을 클릭하거나 게임 내 지정 액션을 수행할 때마다 현재 노드와 대상 노드 사이에 링크를 생성하고, 해당 링크는 즉시 force 시뮬레이션과 배경/전경 레이어에 반영됩니다.
- 이미 존재하는 연결을 중복 생성하지 않도록 ID 쌍을 기준으로 중복 검사를 수행하며, 새 링크가 등장할 때는 짧은 펄스나 사운드 피드백으로 생성 사실을 알립니다.
- 장식용 노드는 링크 대상에서 제외되며, 플레이어 진행도에는 영향을 주지 않습니다.

## 추가 8 — 완전 연결 축하 이벤트
- “완전 연결” 상태는 상호작용 가능한 노드들이 단일 연결 요소를 이루어 어떤 노드도 고립되지 않은 순간으로 정의하며, 장식용 노드는 조건 계산에서 제외합니다.
- 조건을 최초로 만족할 때(세션당 1회) `I love you.mp4` 영상을 전체 화면 팝업으로 자동 재생하고, 기존 팝업이 열려 있다면 닫은 뒤 축하 팝업으로 교체합니다.
- 축하 시퀀스는 그래프 레이아웃을 2단계 애니메이션으로 전환합니다: (1) 1초 동안 노드를 원형 도넛 형태(두 개의 반지름 범위 사이)로 재배치, (2) 이어서 하트 곡선 배치로 2초간 부드럽게 인터폴레이션합니다.
- 애니메이션 도중에는 force 시뮬레이션을 일시적으로 감쇠하거나 중단해 지정된 목표 좌표로 수렴시키고, 시퀀스가 끝나면 기존 force 설정을 재가동합니다.
- 축하 팝업에는 재생 제어(닫기, 다시 보기)가 포함되며, 영상 종료 또는 사용자가 닫기 버튼을 누르면 일반 인터랙션 모드로 복귀합니다.
