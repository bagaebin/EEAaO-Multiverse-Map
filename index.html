<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>관계망 인포그래픽 (D3.js)</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    :root {
      --bg-color: #050810;
      --accent: #3ff2ff;
      --accent-strong: #0a9fff;
      --accent-soft: rgba(63, 242, 255, 0.4);
      --text-primary: #d7f9ff;
      --text-secondary: rgba(215, 249, 255, 0.6);
      font-family: "Orbitron", "Pretendard", sans-serif;
    }

    @import url("https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap");

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at center, rgba(32, 70, 122, 0.2) 0%, rgba(5, 8, 16, 0.95) 55%, #020409 100%);
      color: var(--text-primary);
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .hud {
      position: absolute;
      inset: 0;
      pointer-events: none;
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .hud__banner {
      position: absolute;
      top: 24px;
      left: 32px;
      background: rgba(12, 36, 64, 0.55);
      border: 1px solid rgba(63, 242, 255, 0.4);
      padding: 8px 16px;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.15);
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .hud__banner::before {
      content: "\25a0";
      color: var(--accent);
    }

    .hud__banner-success {
      color: var(--accent);
    }

    .hud__title {
      position: absolute;
      top: 120px;
      left: 32px;
      font-size: 32px;
      font-weight: 700;
      letter-spacing: 0.2em;
      color: var(--accent);
      text-shadow: 0 0 18px rgba(63, 242, 255, 0.6);
    }

    .hud__panel {
      position: absolute;
      top: 160px;
      right: 48px;
      background: rgba(7, 18, 32, 0.85);
      border: 1px solid rgba(63, 242, 255, 0.4);
      padding: 16px 20px;
      width: 220px;
      box-shadow: 0 0 30px rgba(63, 242, 255, 0.15);
    }

    .hud__panel-title {
      font-size: 10px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .hud__panel-list {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 11px;
      line-height: 1.6;
    }

    .hud__panel-list li {
      display: flex;
      justify-content: space-between;
      color: var(--text-secondary);
    }

    .hud__panel-list span {
      color: var(--accent);
    }

    .scene-container {
      position: relative;
      width: min(880px, 70vw);
      height: min(880px, 70vw);
      border-radius: 50%;
      background: radial-gradient(circle, rgba(8, 114, 230, 0.35) 0%, rgba(9, 44, 103, 0.45) 45%, rgba(4, 16, 36, 0.9) 100%);
      box-shadow: inset 0 0 80px rgba(0, 102, 204, 0.6), 0 0 60px rgba(63, 242, 255, 0.25);
      overflow: hidden;
    }

    svg {
      width: 100%;
      height: 100%;
    }

    line.link {
      stroke: rgba(63, 242, 255, 0.4);
      stroke-width: 1.4;
      opacity: 0.85;
    }

    circle.node {
      fill: var(--accent);
      cursor: pointer;
      filter: url(#glow);
    }

    text.label {
      font-size: 11px;
      font-family: "Pretendard", sans-serif;
      fill: var(--text-primary);
      text-shadow: 0 0 6px rgba(63, 242, 255, 0.5);
    }

    .pulse-ring {
      position: absolute;
      inset: 50%;
      width: 60%;
      height: 60%;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      border: 1px solid rgba(63, 242, 255, 0.25);
      animation: pulse 5s infinite linear;
      pointer-events: none;
    }

    .pulse-ring:nth-child(2) {
      width: 75%;
      height: 75%;
      animation-delay: 1.5s;
    }

    .pulse-ring:nth-child(3) {
      width: 90%;
      height: 90%;
      animation-delay: 3s;
    }

    @keyframes pulse {
      0% {
        transform: translate(-50%, -50%) scale(0.95);
        opacity: 0.9;
      }
      100% {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 0.1;
      }
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 16px;
      border: 1px solid rgba(63, 242, 255, 0.45);
      box-shadow: 0 40px 70px rgba(3, 12, 26, 0.6);
      background: rgba(4, 12, 24, 0.95);
      padding: 12px;
      display: none;
      z-index: 10;
    }

    .popup img {
      display: block;
      max-width: 70vw;
      max-height: 70vh;
      border-radius: 12px;
    }

    .popup-close {
      position: absolute;
      top: 6px;
      right: 8px;
      cursor: pointer;
      font-size: 18px;
      color: var(--accent);
      text-shadow: 0 0 8px rgba(63, 242, 255, 0.4);
    }

    .legend {
      position: absolute;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 24px;
      pointer-events: none;
      color: var(--text-secondary);
      font-size: 11px;
      text-transform: uppercase;
    }

    .legend::before,
    .legend::after {
      content: "";
      width: 32px;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(63, 242, 255, 0.7), transparent);
      align-self: center;
    }
  </style>
</head>
<body>
  <div class="scene-container">
    <svg viewBox="0 0 800 800">
      <defs>
        <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
          <feGaussianBlur stdDeviation="6" result="coloredBlur" />
          <feMerge>
            <feMergeNode in="coloredBlur" />
            <feMergeNode in="SourceGraphic" />
          </feMerge>
        </filter>
      </defs>
    </svg>
    <div class="pulse-ring"></div>
    <div class="pulse-ring"></div>
    <div class="pulse-ring"></div>
  </div>

  <div class="hud">
    <div class="hud__banner">
      <span>Jumping Pads Compiled.</span>
      <span class="hud__banner-success">Success!</span>
    </div>
    <div class="hud__title">Calculation Complete</div>
    <aside class="hud__panel">
      <div class="hud__panel-title">Improbable Actions</div>
      <ul class="hud__panel-list">
        <li><span>0.0012%</span> 프로세스를 사랑하다</li>
        <li><span>0.0024%</span> 머리카락 모두 자르기</li>
        <li><span>0.0045%</span> 창문 밖으로 뛰다</li>
        <li><span>0.0056%</span> 코 부러뜨리기</li>
        <li><span>0.0082%</span> 팔꿈치 핥기</li>
        <li><span>0.0099%</span> 200번 재채기</li>
        <li><span>0.0121%</span> 아빠에게 고해성사</li>
        <li><span>0.0138%</span> 항공기에서 뛰다</li>
        <li><span>0.0156%</span> 소설 쓰기</li>
        <li><span>0.0174%</span> 혀끝을 떼기</li>
        <li><span>0.0191%</span> 눈알 빼기</li>
      </ul>
    </aside>
    <div class="legend">Multiverse Trajectories</div>
  </div>

  <div class="popup" id="popup">
    <span class="popup-close" onclick="hidePopup()">✕</span>
    <img id="popupImg" src="" alt="node image" />
  </div>

  <script>
    const nodes = [
      { id: "Cook", img: "images/001.png" },
      { id: "Kung-Fu", img: "images/002(need edited).png" },
      { id: "Actor", img: "images/003.png" },
      { id: "Mom", img: "images/004.png" },
      { id: "Singer", img: "images/005.png" }
    ];

    const links = [
      { source: "Cook", target: "Kung-Fu" },
      { source: "Kung-Fu", target: "Actor" },
      { source: "Actor", target: "Mom" },
      { source: "Mom", target: "Actor" },
      { source: "Singer", target: "Cook" }
    ];

    const svg = d3.select("svg");
    const width = 800;
    const height = 800;

    const simulation = d3.forceSimulation(nodes)
      .force("link", d3.forceLink(links).id(d => d.id).distance(160).strength(0.3))
      .force("charge", d3.forceManyBody().strength(-220))
      .force("center", d3.forceCenter(width / 2, height / 2))
      .force("radial", d3.forceRadial(250, width / 2, height / 2).strength(0.08));

    const link = svg.append("g")
      .attr("stroke-linecap", "round")
      .selectAll("line")
      .data(links)
      .join("line")
      .attr("class", "link");

    const node = svg.append("g")
      .selectAll("circle")
      .data(nodes)
      .join("circle")
      .attr("class", "node")
      .attr("r", 8)
      .on("click", (event, d) => showPopup(d.img))
      .call(drag(simulation));

    const label = svg.append("g")
      .selectAll("text")
      .data(nodes)
      .join("text")
      .attr("class", "label")
      .text(d => d.id);

    simulation.on("tick", () => {
      link
        .attr("x1", d => d.source.x)
        .attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x)
        .attr("y2", d => d.target.y);

      node
        .attr("cx", d => d.x)
        .attr("cy", d => d.y);

      label
        .attr("x", d => d.x + 12)
        .attr("y", d => d.y + 4);
    });

    function drag(simulation) {
      function dragstarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
      }

      function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
      }

      function dragended(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
      }

      return d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended);
    }

    function showPopup(imgUrl) {
      const popup = document.getElementById("popup");
      const popupImg = document.getElementById("popupImg");
      popupImg.src = imgUrl;
      popup.style.display = "block";
    }

    function hidePopup() {
      document.getElementById("popup").style.display = "none";
    }

    window.addEventListener("keydown", (event) => {
      if (event.key === "Escape") hidePopup();
    });
  </script>
</body>
</html>
